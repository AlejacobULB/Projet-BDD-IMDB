\documentclass[10pt,a4paper]{article}
\usepackage[left=1.5cm,right=1.5cm,top=3cm,bottom=3cm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[export]{adjustbox}
\usepackage[french]{babel}
\usepackage{graphicx}
\usepackage{eso-pic}
\usepackage{transparent}
\usepackage[export]{adjustbox}
\usepackage{hyperref} \hypersetup{colorlinks, citecolor=black, filecolor=black, linkcolor=black, urlcolor=black,}
\usepackage{xcolor,listings}
\usepackage{textcomp}
\lstset{upquote=true}

% 1 : Logo ulb en fond
\newcommand\BackgroundPic{%
    \put(0,-47){%
        \parbox[b][\paperheight]{\paperwidth}{%
            \vfill
            \centering
            {\transparent{0.09}\includegraphics[width=1.17 \textwidth]{logo_ulb.jpg}}%
            \vfill
        }
    }
}
\begin{document}
\AddToShipoutPicture*{\BackgroundPic}

\begin{titlepage}
\begin{center}
\vspace*{-1.5cm}
\includegraphics[width=8cm]{ULB.jpg}
\vspace{6cm}

\par{\huge \textbf{Rapport Projet}}\bigbreak
\bigbreak
\par{\huge \textbf{\textit{{IMDB: Internet Movie Database}}}}
\vspace{2cm}
\par{\large [Cours: INFO-H-303]}
\vspace{2cm}

\par \hrulefill \par
\vspace{1cm}
\bsc{Jacobs} Alexandre 
\bsc{\&}
\bsc{Engelman} David
\bsc{\&}
\bsc{Engelman} Benjamin
{\emph \\BA2 Informatique}
\vspace{0.7cm}
\par \hrulefill \par

\vspace{2cm}
\par Mai 2017

\end{center}
\end{titlepage}
\newpage
\tableofcontents
\newpage

\section{Introduction}
Dans le cadre du cours de "Base de donnée", nous avons du réaliser un projet mettant en applications les différents concepts vus en cours et lors des séances de travaux pratiques.
\subsection{But du projet}
Ici le but fût à partir de fichiers disponible sur internet de récréer un base de donnée sur le concept de "IMDB: Internet Movie Database". Le projet fut divisé en deux grandes parties, la première partie (section \ref{première partie}) étant la création d'un diagramme entité-association et un diagramme relationnel. La seconde partie (section \ref{deuxieme partie}) fut la plus pratique qui était l'implémentation de la base de donnée. \\

En plus de devoir faire une base de donnée, nous avons dû faire les scripts qui permettaient la création de la base de donnée et l'extraction des données qui y sont stockés. Aussi à fin de pouvoir utiliser notre base de donnée, nous avons crée un site web permettant de rechercher sur des critère simple ou avancés des oeuvres(film, série ou épisodes), des personnes(acteur, directeur, auteur).

\newpage
\section{Première Partie}\label{première partie}

\subsection{Modèle entité-association}

\subsection{Modèle relationnel}

\newpage
\section{Deuxième Partie}\label{deuxieme partie}

\subsection{Méthode d'extraction des données}

\subsection{Requêtes demandées}
Les requêtes demandées étaient les suivantes:
\begin{list}{-}{}
  \item R1 : Les acteurs qui ont joué toutes les années entre 2003 et
    2007.
  \item R2 : Les auteurs qui ont écrit au moins deux films pendant la
    même année.
  \item R3 : Les acteurs Y qui sont à une distance 2 d'un acteur X. Un
    acteur Y est à une distance 1 d'un acteur X si ces deux acteurs
    ont joué dans le même film.
  \item R4 : Les épisodes de série où il n'y a aucun acteur masculin.
  \item R5 : Les acteurs qui ont joué dans le plus de séries.
  \item R6 : Les séries avec leur nombre total d'épisodes, le nombre
    d'épisodes moyen par an et le nombre d'acteurs moyen par saison
    depuis leur année de création et ce pour toutes les séries dont la
    note est supérieure à la moyenne des notes des séries.
\end{list}
\subsubsection{SQL}
\begin{lstlisting}[
           language=SQL,
           showspaces=false,
           basicstyle=\ttfamily,
           numbers=left,
           numberstyle=\tiny,
           commentstyle=\color{blue},
           caption = Requête 1,
           captionpos = b, 
           tabsize = 4
        ]
/*R1*/
SELECT Nom, Prenom, Numero
FROM Acteur a
WHERE (SELECT count(distinct AnneeSortie)
	   FROM (
			SELECT AnneeSortie, Nom, Prenom, Numero
			FROM Oeuvre o INNER JOIN Role r
			ON ID = OID
			WHERE AnneeSortie BETWEEN 2003 AND 2007) t
	   WHERE t.Prenom = a.Prenom and t.Nom = a.Nom and t.Numero = a.Numero) = 5;
/*R1 bis*/:
SELECT Nom, Prenom, Numero
FROM (
	SELECT AnneeSortie, Nom, Prenom, Numero
	FROM Oeuvre o INNER JOIN Role r
	ON ID = OID
	WHERE AnneeSortie BETWEEN 2003 AND 2007) t
group by Nom, Prenom, Numero
having count(distinct AnneeSortie) = 5;
\end{lstlisting}
\begin{lstlisting}[
           language=SQL,
           showspaces=false,
           basicstyle=\ttfamily,
           numbers=left,
           numberstyle=\tiny,
           commentstyle=\color{blue},
           caption = Requête 2,
           captionpos = b,
           tabsize = 4
        ]
/*R2*/
SELECT distinct Nom, Prenom, Numero
FROM(
	SELECT AnneeSortie, Nom,Prenom, Numero
	FROM Oeuvre o
	INNER JOIN Film f ON o.ID = f.FilmID
	INNER JOIN EcritPar ON ID = OID
	group by AnneeSortie, Nom, Prenom, Numero
	having count(*) >=2 )t;
\end{lstlisting}

\newpage
\begin{lstlisting}[
           language=SQL,
           showspaces=false,
           basicstyle=\ttfamily,
           numbers=left,
           numberstyle=\tiny,
           commentstyle=\color{blue},
           caption = Requête 3,
           captionpos = b,
           tabsize = 4
        ]
/*R3*/
SELECT distinct Nom, Prenom, Numero
FROM(
	SELECT OID
	FROM(
		SELECT 	R2.OID
		FROM(
			SELECT T2.Nom, T2.Prenom, T2.Numero, T2.OID
			FROM(
					SELECT R1.Prenom, R1.Nom, R1.Numero, R1.OID
					FROM (
						SELECT *
						FROM Role
						WHERE Nom = 'Willis' and Prenom = 'Bruce' and Numero = 'NA') as T
						JOIN Role R1 ON T.OID = R1.OID) as T2
			INNER JOIN Film F on F.FilmID = T2.OID) as T3
		JOIN Role R2 ON T3.Prenom = R2.Prenom AND T3.Nom = R2.Nom AND T3.Numero = R2.Numero) as T4
	INNER JOIN Film F2 on F2.FilmID = T4.OID) as T5
JOIN Role R3 ON T5.OID = R3.OID;
\end{lstlisting}

\begin{lstlisting}[
           language=SQL,
           showspaces=false,
           basicstyle=\ttfamily,
           numbers=left,
           numberstyle=\tiny,
           commentstyle=\color{blue},
           caption = Requête 4,
           captionpos = b,
           tabsize = 4
        ]
/*R4*/
Select distinct e.EpisodeID, e.SID 
	From Episode e 
    Where Not Exists( 
        Select a.OID 
        From Role a, Personne p 
        	Where p.Numero = a.Numero and a.Nom = p.Nom and a.Prenom = p.Prenom 
                and p.Genre = 'm' and a.OID = e.EpisodeID);

/*R4 bis*/
SELECT distinct EpisodeID
FROM Episode e
WHERE NOT EXISTS(
	SELECT Genre, EpisodeID
	FROM Role INNER Join Personne on  Personne.Nom = Role.Nom AND Personne.Prenom = Role.Prenom 
    			AND Personne.Numero  = Role.Numero
	WHERE genre = 'm' AND OID = e.EpisodeID
    );
    
\end{lstlisting}
\subsubsection{Algèbre relationnel}
\subsubsection{Calcul relationnel tuple}

\section{Conclusion}
\end{document}